<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>すいれん - 運営用ページ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>すいれん</h1>
            <p class="subtitle">運営用ページ</p>
        </header>

        <main>
            <!-- 認証画面 -->
            <div id="authScreen" class="login-screen">
                <section class="login-section">
                    <h2>運営認証</h2>
                    <div class="login-form">
                        <label for="adminPassword">パスワード</label>
                        <input type="password" id="adminPassword" placeholder="パスワードを入力" required>
                        
                        <button id="adminLoginButton" class="login-button">ログイン</button>
                    </div>
                    <div id="adminError" class="error-message" style="display: none;"></div>
                </section>
            </div>

            <!-- 運営画面 -->
            <div id="adminScreen" style="display: none;">
                <!-- メインメニュー -->
                <section class="admin-main-menu">
                    <h2>メインメニュー</h2>
                    <div class="admin-menu-buttons">
                        <button id="pointsPageButton" class="admin-menu-button">
                            <span class="button-icon">🎁</span>
                            <span class="button-text">ポイントをつける</span>
                            <span class="button-description">未処理の受け取り記録を処理してポイントを付与</span>
                        </button>
                        <button id="salesPageButton" class="admin-menu-button">
                            <span class="button-icon">📊</span>
                            <span class="button-text">売り上げを確認</span>
                            <span class="button-description">すべての取引記録と売り上げを確認</span>
                        </button>
                    </div>
                </section>

                <!-- ポイント付与ページ -->
                <div id="pointsPage" style="display: none;">
                    <!-- PayPayスクリーンショット解析セクション -->
                    <section class="screenshot-analysis-section">
                        <div class="page-header">
                            <button id="backToMainButton" class="back-button">← メインメニューに戻る</button>
                            <h2>PayPay取引履歴から自動ポイント付与</h2>
                        </div>
                        <div class="chatgpt-instruction-area">
                            <h3>📸 ChatGPTで解析した結果を入力</h3>
                            <div class="instruction-steps">
                                <div class="step">
                                    <p class="step-number">1</p>
                                    <p class="step-text">PayPayアプリで「取引履歴」→「絞り込み」→「入金・受け取りのみ」を表示し、スクリーンショットを撮影</p>
                                </div>
                                <div class="step">
                                    <p class="step-number">2</p>
                                    <p class="step-text">ブラウザのChatGPTにスクリーンショットをアップロード</p>
                                </div>
                                <div class="step">
                                    <p class="step-number">3</p>
                                    <p class="step-text">以下のプロンプトをChatGPTに送信：</p>
                                    <div class="prompt-box">
                                        <pre id="chatgptPrompt">このPayPayの取引履歴（入金・受け取りのみ）のスクリーンショットから、以下のJSON形式で取引情報を抽出してください：

{
  "transactions": [
    {
      "amount": 金額（数値のみ）,
      "sender_name": "送金者の名前（表示されている場合）",
      "date": "日時（表示されている場合）",
      "memo": "メモ（表示されている場合）"
    }
  ]
}

取引が複数ある場合は、すべての取引を配列に含めてください。金額は必ず数値で返してください（例: 1000）。</pre>
                                        <button id="copyPromptButton" class="copy-prompt-button">📋 プロンプトをコピー</button>
                                    </div>
                                </div>
                                <div class="step">
                                    <p class="step-number">4</p>
                                    <p class="step-text">ChatGPTが出力したJSONを下のテキストエリアに貼り付けて「ポイントを付与」をクリック</p>
                                </div>
                            </div>
                            <div class="json-input-area">
                                <label for="chatgptJsonInput">ChatGPTが出力したJSON:</label>
                                <textarea id="chatgptJsonInput" class="json-input" placeholder='{"transactions": [{"amount": 1000, "sender_name": "田中太郎"}]}'></textarea>
                                <button id="applyPointsFromJsonButton" class="apply-points-button">
                                    ✅ ポイントを付与
                                </button>
                            </div>
                            <div id="jsonResult" class="json-result" style="display: none;">
                                <h4>処理結果</h4>
                                <div id="jsonResultContent"></div>
                            </div>
                        </div>
                    </section>

                    <!-- 未処理の受け取り記録セクション -->
                    <section class="pending-receipts-section">
                        <h2>未処理の受け取り記録（手動処理）</h2>
                        <div id="pendingReceiptsArea">
                            <p class="loading-text">読み込み中...</p>
                        </div>
                    </section>
                </div>

                <!-- 売り上げ確認ページ -->
                <div id="salesPage" style="display: none;">
                    <section class="all-data-section">
                        <div class="page-header">
                            <button id="backToMainButton2" class="back-button">← メインメニューに戻る</button>
                            <h2>売り上げ・取引記録</h2>
                        </div>
                        <div class="data-tabs">
                            <button class="tab-button active" onclick="showTab('receipts')">受け取り記録（全件）</button>
                            <button class="tab-button" onclick="showTab('payments')">支払い記録（全件）</button>
                        </div>
                        
                        <div id="receiptsTab" class="tab-content active">
                            <div id="allReceiptsArea">
                                <p class="loading-text">読み込み中...</p>
                            </div>
                        </div>
                        
                        <div id="paymentsTab" class="tab-content" style="display: none;">
                            <div id="allPaymentsArea">
                                <p class="loading-text">読み込み中...</p>
                            </div>
                        </div>
                    </section>
                </div>

                <section class="admin-actions">
                    <button id="logoutAdminButton" class="logout-button">ログアウト</button>
                </section>
            </div>
        </main>
    </div>

    <script src="admin.js"></script>
</body>
</html>
