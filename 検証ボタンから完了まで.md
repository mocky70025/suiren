# 検証ボタンから完了までの手順

## 🎯 検証ボタンを押した直後から

検証ボタンを押したら、画面に何が表示されるか確認してください。

## 📋 ステップ1: 検証結果を確認

### 検証ボタンを押す

1. 「検証」ボタンをクリック
2. 数秒待つ（処理中...と表示される場合があります）

### 結果を確認

画面に以下のいずれかが表示されます：

#### ✅ パターン1: 成功した場合

**表示される内容**：
- ✅ 「Webhook URLの検証に成功しました」というメッセージ
- または「検証成功」という表示
- 「Webhookイベントの受信」が自動的に「利用する」に変わる

**この場合**：
→ ステップ2に進みます

#### ❌ パターン2: 失敗した場合

**表示される内容**：
- ❌ 「Webhook URLに接続できませんでした」
- または「検証失敗」という表示
- エラーメッセージが表示される

**この場合**：
→ 「トラブルシューティング」セクションを確認してください

## 📋 ステップ2: 「Webhookの利用」を確認・設定

検証が成功したら、次に「Webhookの利用」を確認します。

### 2-1. 「Webhookの利用」セクションを探す

1. ページを下にスクロール
2. 「Webhook URL」の下に「Webhookの利用」というセクションがあります
3. トグルスイッチまたはラジオボタンがあります

### 2-2. 「利用する」に設定

1. 「Webhookの利用」のトグルスイッチを確認
2. **「利用する」になっているか確認**
   - 検証が成功すると、自動的に「利用する」になっている場合が多いです
   - もし「利用しない」になっていたら、**「利用する」に変更**してください

## 📋 ステップ3: 「応答メッセージ」を「利用しない」に設定

### 3-1. 「応答メッセージ」セクションを探す

1. 「Webhookの利用」の下に「応答メッセージ」というセクションがあります
2. トグルスイッチまたはラジオボタンがあります

### 3-2. 「利用しない」に設定

1. 「応答メッセージ」のトグルスイッチを確認
2. **「利用しない」に設定**してください
   - ⚠️ **重要**：これにより、あなたのサーバーがメッセージを処理できます
   - 「利用する」のままにすると、LINEの自動応答が優先されてしまいます

## 📋 ステップ4: 設定を保存

### 4-1. 保存ボタンを探す

1. ページの上部または下部に「保存」または「更新」ボタンがあります
2. または、各セクションに個別の保存ボタンがある場合もあります

### 4-2. 保存を実行

1. 「保存」または「更新」ボタンをクリック
2. 保存が完了するまで待つ（数秒かかる場合があります）
3. 成功メッセージが表示されれば完了です

## ✅ 完了チェックリスト

設定が完了したら、以下を確認してください：

- [ ] 「検証」ボタンをクリックした
- [ ] 検証が成功した（成功メッセージが表示された）
- [ ] 「Webhookの利用」が「利用する」になっている
- [ ] 「応答メッセージ」が「利用しない」になっている
- [ ] 設定を保存した

## 🔍 画面の見方（詳しく）

### LINE Developers Consoleの画面構成

```
┌─────────────────────────────────────────┐
│ LINE Developers Console                 │
│                                          │
│ 左メニュー          │ メインコンテンツ    │
│ ├─ チャネル基本設定 │                    │
│ ├─ Messaging API ← ここを開いている     │
│ └─ ...            │                    │
│                    │                    │
│                    │ ┌────────────────┐ │
│                    │ │ Webhook URL    │ │
│                    │ │ [URL入力欄]    │ │
│                    │ │ [更新][検証] ← │ │
│                    │ │ ✅ 検証成功    │ │
│                    │ └────────────────┘ │
│                    │                    │
│                    │ ┌────────────────┐ │
│                    │ │ Webhookの利用  │ │
│                    │ │ ○ 利用する ←  │ │
│                    │ │ ● 利用しない   │ │
│                    │ └────────────────┘ │
│                    │                    │
│                    │ ┌────────────────┐ │
│                    │ │ 応答メッセージ  │ │
│                    │ │ ● 利用する     │ │
│                    │ │ ○ 利用しない ← │ │
│                    │ └────────────────┘ │
│                    │                    │
│                    │ [保存] ← ここをクリック │
└─────────────────────────────────────────┘
```

## ⚠️ トラブルシューティング

### 検証が失敗した場合

#### エラー1: 「Webhook URLに接続できませんでした」

**対処法**：

1. **Render Dashboardでサーバーを確認**
   - [Render Dashboard](https://dashboard.render.com/) にアクセス
   - あなたのサービスを選択
   - 「Logs」タブを開く
   - サーバーが起動しているか確認
   - エラーが出ていないか確認

2. **URLを再確認**
   - Webhook URLが正しいか確認
   - `https://` で始まっているか
   - `/api/line/webhook` で終わっているか
   - 余分なスペースがないか

3. **数分待つ**
   - デプロイ直後は反映に時間がかかる場合があります
   - 5分程度待ってから再度検証

#### エラー2: 「チャネルシークレットが一致しません」

**対処法**：

1. **Render Dashboardで環境変数を確認**
   - 環境変数タブを開く
   - `LINE_CHANNEL_SECRET` が `1017478a22eb4c810faaeebebf10e0ee` になっているか確認

2. **サーバーを再デプロイ**
   - 環境変数を変更した場合は、再デプロイが必要です

## 🎉 完了後の次のステップ

設定が完了したら：

1. **LINE公式アカウントを友だち追加**
   - LINE Developers Consoleで「チャネル基本設定」→「QRコード」を開く
   - QRコードをLINEアプリでスキャン

2. **動作確認**
   - LINE公式アカウントにメッセージを送信
   - Render Dashboardの「Logs」タブでWebhookイベントが受信されているか確認

## 💡 よくある質問

### Q: 「Webhookの利用」が見つからない

A: ページを下にスクロールしてください。「Webhook URL」の下にあります。

### Q: 「応答メッセージ」が見つからない

A: 「Webhookの利用」の下にあります。ページを下にスクロールしてください。

### Q: 保存ボタンが見つからない

A: ページの上部または下部を確認してください。または、各セクションに個別の保存ボタンがある場合もあります。

### Q: 検証は成功したけど、メッセージが返ってこない

A: 「応答メッセージ」が「利用しない」になっているか確認してください。また、LINEユーザーIDをシステムユーザーと紐づける必要があります。

