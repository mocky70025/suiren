# リッチメニューから飛ぶリンク

## 📋 現在のリンク設定

### 1. 支払いリンク

```
https://あなたのRenderサービスのURL/?action=payment
```

**例**:
```
https://suiren.onrender.com/?action=payment
```

**注意**: このリンクには`line_user_id`が含まれていないため、自動ログインはできません。ユーザーは手動でログインする必要があります。

### 2. ポイントカード

現在は**Postbackアクション**を使用しているため、リンクではなくLINE内でFlex Messageが表示されます。

- アクションタイプ: `postback`
- データ: `action=points_card`
- 表示: LINE内でポイントカードがFlex Messageとして表示される

## 🔧 リッチメニュー設定方法（LINE公式アカウントから）

### ステップ1: LINE公式アカウントマネージャーにアクセス

1. [LINE公式アカウントマネージャー](https://manager.line.biz/)にログイン
2. あなたの公式アカウントを選択
3. 「リッチメニュー」をクリック

### ステップ2: リッチメニューを作成

1. 「作成」ボタンをクリック
2. リッチメニューの名前を入力（例: 「すいれんメニュー」）
3. 画像をアップロード（2500×1686ピクセル、PNG形式）
   - 左半分: スタンプカード
   - 右半分: 支払い

### ステップ3: アクションを設定

#### 左側（スタンプカード）の設定

**方法1: Postbackアクション（推奨）**
- アクションタイプ: `Postback`
- データ: `action=points_card`
- 表示テキスト: `スタンプカードを表示`

**方法2: URIアクション（リンク）**
- アクションタイプ: `URI`
- URL: `https://あなたのRenderサービスのURL/?action=points_card`
- 例: `https://suiren.onrender.com/?action=points_card`

#### 右側（支払い）の設定

- アクションタイプ: `URI`
- URL: `https://あなたのRenderサービスのURL/?action=payment`
- 例: `https://suiren.onrender.com/?action=payment`

### ステップ4: リッチメニューを公開

1. 「公開」ボタンをクリック
2. LINEアプリを再起動して確認

## 🔄 自動ログインを有効にする場合

現在の実装では、`line_user_id`をURLパラメータに含めることができません（リッチメニューは固定URLのみ）。

自動ログインを有効にするには、以下のいずれかの方法が必要です：

### 方法1: LINEログインを使用

支払いリンクからLINEログインボタンを表示し、LINEログインで認証する。

### 方法2: Webhookで処理

Postbackアクションを使用し、Webhookで処理してからリンクを送信する。

## 📝 現在の実装状況

- ✅ 支払いリンク: `/action=payment` でアクセス可能
- ✅ ポイントカード: PostbackでFlex Message表示
- ⚠️ 自動ログイン: `line_user_id`を含める方法を検討中

## 💡 推奨設定

### スタンプカード（左側）
- **Postbackアクション**を使用（現在の実装）
- データ: `action=points_card`
- LINE内で直接ポイントカードが表示される

### 支払い（右側）
- **URIアクション**を使用
- URL: `https://あなたのRenderサービスのURL/?action=payment`
- ユーザーは手動でログインする必要がある

