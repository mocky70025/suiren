# リッチメニュー作成方法

## 🎯 リッチメニューとは

リッチメニューは、LINE公式アカウントのトーク画面下部に表示されるメニューです。
- 「スタンプカード」ボタン：ポイントカードを表示
- 「支払い」ボタン：支払いページを開く

## ✅ 自動設定（推奨）

**既に実装済みです！** サーバー起動時に自動的にリッチメニューが作成・設定されます。

### 動作確認

1. Renderでサーバーが起動していることを確認
2. LINE公式アカウントを開く
3. 下部にメニューが表示されることを確認
4. 表示されない場合は、LINEアプリを再起動してください

## 🎨 画像を追加する場合（オプション）

リッチメニューは画像なしでも動作しますが、画像を追加すると見た目が良くなります。

### ステップ1: 画像を用意

1. **サイズ**: 2500×1686ピクセル
2. **形式**: PNG形式
3. **レイアウト**:
   - 左半分（0-1250px）：スタンプカードボタン用
   - 右半分（1250-2500px）：支払いボタン用

### ステップ2: 画像を配置

1. プロジェクトの `assets` フォルダを作成（まだない場合）
2. 画像を `assets/richmenu_image.png` として保存

```
すいれん/
  ├── assets/
  │   └── richmenu_image.png  ← ここに配置
  ├── server/
  └── ...
```

### ステップ3: GitHubにプッシュ

```bash
cd "/Users/mocky700/Desktop/個人利用/すいれん"
git add assets/richmenu_image.png
git commit -m "リッチメニュー画像を追加"
git push
```

### ステップ4: 再デプロイ

Renderで自動的に再デプロイが開始されます。デプロイ完了後、サーバー起動時に画像が自動的にアップロードされます。

## 🔄 手動で再作成する場合

サーバー起動時に自動設定されますが、手動で再作成したい場合は以下の方法があります。

### 方法1: サーバーを再起動

Renderのダッシュボードから：
1. サービスを選択
2. 「Manual Deploy」→「Deploy latest commit」をクリック
3. または、環境変数を変更して保存（自動再起動）

### 方法2: APIエンドポイントを使用（開発中）

将来的には、運営画面から手動で作成できるようになる予定です。

## 📋 リッチメニューの構成

現在のリッチメニューは以下のように設定されています：

| 位置 | ボタン名 | アクション | 説明 |
|------|---------|----------|------|
| 左半分 | スタンプカード | Postback | ポイントカードをFlex Messageで表示 |
| 右半分 | 支払い | URI | 支払いページを開く（LINEユーザーIDで自動ログイン） |

## ✅ 動作確認チェックリスト

- [ ] サーバーが起動している
- [ ] LINE公式アカウントを開く
- [ ] 下部にメニューが表示される（LINEアプリ再起動が必要な場合あり）
- [ ] 「スタンプカード」ボタンをクリック → ポイントカードが表示される
- [ ] 「支払い」ボタンをクリック → 支払いページが開く

## ⚠️ 注意事項

1. **LINEアプリの再起動**: リッチメニューの変更は、LINEアプリを再起動しないと反映されない場合があります
2. **1チャネル1メニュー**: 1つのチャネルには1つのリッチメニューしか設定できません（既存のメニューは自動削除されます）
3. **環境変数**: `LINE_CHANNEL_ACCESS_TOKEN` が設定されている必要があります

## 🐛 トラブルシューティング

### メニューが表示されない

1. LINEアプリを完全に終了して再起動
2. サーバーのログを確認（リッチメニュー設定のエラーがないか）
3. 環境変数 `LINE_CHANNEL_ACCESS_TOKEN` が正しく設定されているか確認

### エラーが発生する

サーバーのログを確認してください。よくあるエラー：
- `no channel access token`: 環境変数が設定されていない
- `rich menu already exists`: 既存のメニューを削除中（自動で処理されます）

## 💡 現在の実装

- ✅ サーバー起動時に自動設定
- ✅ 既存メニューの自動削除
- ✅ 画像なしでも動作
- ✅ エラーハンドリング

リッチメニューは既に自動設定されているので、特別な操作は不要です！

